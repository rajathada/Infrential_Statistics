---
title: "Statistical inference with the GSS data"
output: 
  html_document: 
    fig_height: 4
    highlight: pygments
    theme: spacelab
---

## Setup

### Load packages

```{r load-packages, message = FALSE}
library(ggplot2)
library(dplyr)
library(statsr)
```

### Load data


```{r load-data}
load("gss.Rdata")
```



* * *
### Dataset Discription


**<u>Data:</u>** Data is from General Social Survey(GSS) for a sampled population which shows the trend in attitudes, behavirs and attributes on contemporary Americans society. Purpose of this survey to examine th structure and functioning of society in general. Also, to compare American Society with other society and develop cross-national models of human society.

**<u>Data Collection and Implication:</u>** Survey is conducted mainly by random Sampling. Thus, we can generalize the result using Infrential Statistics tools. There is no random assignment hence no causal relation can be established.


* * *

## Part 2: Research question

### Research Question

**<u>Question:</u>** We want to answer if there is any relationship between How often does people read newspaper and their age group. Our focus area will be two age group Young(25-50) and old(50-75). 

We will create new variable Age_Group_Type, which have two categorical variables:

* Young (which has age between 25-50, 25 and 50 both included)
* Old (Which has age between 50-75, 50 excluded but 75 included)
  
**<u>Motivation:</u>** There is a preconceived notion that as aged people reads newspaper frequently compared to the young people. We want to confirm whether it is true or not based on data.




* * *

## Part 3: Exploratory data analysis

### Data Cleaning

Our variables of interst are column(age) and column(news). So, lets first remove the NA's values from both the columns and subset only those rows which has age between 25 and 75. Then add a new column Age_Group_Type having two levels : "Young" and"Old". 
For safer side, Also convert column(news) and convert column(Age_Group_Type) as factors if R is considering these columns as Character.

```{r}
data <- gss[which(is.na(gss$age) == FALSE), ]
data <- data[which(is.na(data$news) == FALSE),]
data <- data[which(data$age >= 25 & data$age <= 75), ]
data$Age_Group_Type <- ifelse(data$age <= 50, "Young", "Old")
data$Age_Group_Type <- as.factor(data$Age_Group_Type)
data$news <- as.factor(data$news)
```


### Data Exploration

Summary of Age_Group_Type and News.

```{r}
summary(data$Age_Group_Type)
summary(data$news)
```

Lets make the contigency table for Age_Group_Type and News.

```{r}
table(data$Age_Group_Type, data$news)
```

```{r}
ggplot(data = data, aes(x=news, fill = Age_Group_Type)) + geom_bar( aes(y = ..count.. * 100/sum(..count..)), position = position_dodge()) + ylab("%age") + theme(axis.text.x = element_text(angle=60,hjust = 1))
```

*__<U>Observation:</u>__*

* There is a significant differnce between the young and old people those who reads news few times a week, once a week and less than a week. We have check whether there is also significant difference in the whole population or not.


* * *

## Part 4: Inference

As the both variables of interest are Categorical Variable and one of them (news) have more than two levels. So, we will perform __Chi-Squared Independence Test__.


##### __Step-1: State the Hypotheses__

* __<u>Null Hypothesis:</u>__ News reading and Age are independent. Reading newspaper frequency doesn't vary with aging.

* __<u>Alternate Hypothesis:</u>__ News reading and Age are dependent. Reading newspaper frequency vary with aging.

##### __Step-2: Check the Conditions__

1. __<u>Independence</u>__

      + Random Sample/Assignment: As it is already mentioned in the survey was generated by random sampling.
      
      + Also, as the survey is sampling without replacement so the condition n < 10% of population also met. As sampled observations are 29620(after removing NA), which is obviously less than the whole American population.
    
2. __<u>Sample Size:</u>__ Expected count for each cell must be atleast 5 for each cell. Lets check that!


```{r}
chisq.test(data$Age_Group_Type, data$news)$expected
```

From the above table, clearly every cell has an expected count more than 5. We're now all clear to perform chi-squared test of independence!

##### __Step-3: Degree of Freedom__

We have 2 age group and 5 News reading frequency level.

Hence, __df__ __:__ __(2-1)X(5-1)__ __=__ __4__

##### __Step-4: Chi-Squared test of independence__

```{r}
chisq.test(data$news,data$Age_Group_Type)
```

The chi-squared statistic is 1279.9 and the corresponding p-value for 4 degrees of freedom is much lower than the significance level of 0.05. Hence, we reject the Null Hypothesis.

Therfore, __Age and Frequency of reading newspaper is dependent on each other.__

